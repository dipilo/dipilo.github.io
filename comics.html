<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Comics Library</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/styles.css">
  <style>
    body {
      background-color: #F3E5F5;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
    }
    .amy-container {
      max-width: 700px;
      margin: 2rem auto;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 16px rgba(123,31,162,0.08);
      padding: 2rem 1rem;
      overflow-y: auto;
    }
    .amy-title {
      text-align: center;
      color: #7B1FA2;
      margin-bottom: 1.5rem;
      font-size: 2rem;
      font-weight: bold;
      letter-spacing: 0.05em;
    }
    .comic-list {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .comic-item {
      padding: 1rem;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 16px rgba(123,31,162,0.08);
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .comic-item:hover {
      background-color: #f3e5f5;
    }
    .chapter-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      margin-top: 1.5rem;
    }
    .chapter-arrow {
      background: #7B1FA2;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 44px;
      height: 44px;
      font-size: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
      box-shadow: 0 2px 8px rgba(123,31,162,0.07);
      user-select: none;
      line-height: 1;
      padding: 0;
      text-align: center;
      vertical-align: middle;
      font-family: inherit;
    }
    .chapter-arrow:disabled {
      background: #D1B3E0;
      color: #fff;
      cursor: not-allowed;
      opacity: 0.6;
    }
    .chapter-select {
      font-size: 1.1rem;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      border: 2px solid #7B1FA2;
      color: #7B1FA2;
      background: #F3E5F5;
      font-weight: bold;
      outline: none;
      transition: border 0.2s;
    }
    .chapter-select:focus {
      border: 2px solid #4A148C;
    }
    #amy-images {
      overflow-x: hidden;  /* Prevent horizontal scrolling */
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }
    .amy-image {
      display: block;
      width: 100%;
      height: auto;
      margin: 0;
      padding: 0;
      border-radius: 0;
      box-shadow: none;
    }
    .back-arrow-btn {
      position: fixed;
      top: 24px;
      left: 24px;
      z-index: 1000;
      background: #F3E5F5;
      color: #7B1FA2;
      border: none;
      border-radius: 50%;
      width: 44px;
      height: 44px;
      font-size: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
      user-select: none;
      line-height: 1;
      padding: 0;
      text-align: center;
      vertical-align: center;
      font-family: inherit;
      opacity: 1;
      visibility: visible;
    }
    .back-arrow-btn.hide {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }
    @media (max-width: 800px) {
      .amy-container {
        max-width: 98vw;
        padding: 1rem 0.25rem;
      }
      .chapter-nav {
        flex-direction: column;
        gap: 1rem;
      }
      .back-arrow-btn {
        top: 8px;
        left: 8px;
      }
    }
  </style>
</head>
<body>
  <!-- Back arrow button, hidden by default -->
  <button id="back-arrow-btn" class="back-arrow-btn hide" title="Back">
    &#8592;
  </button>
  <main>
    <div class="amy-container">
      <div id="main-title" class="amy-title">Comics Library</div>
      <div id="chapter-nav-top"></div>
      <div id="comic-list" class="comic-list"></div>
      <div id="chapter-nav-bottom"></div>
    </div>
  </main>
  <script>
    // chapters: title, folder, and total page count
    const comics = {
      'I Love Amy' : [
        { title: "Bibi's First Friend",     folder: "/I Love Amy/Chapter 1/",  count: 23 },
        { title: "Amy",                     folder: "/I Love Amy/Chapter 2/",  count: 30 },
        { title: "Operation: Meat Pie",     folder: "/I Love Amy/Chapter 3/",  count: 23 },
        { title: "The Prom (1)",            folder: "/I Love Amy/Chapter 4/",  count: 33 },
        { title: "The Prom (2)",            folder: "/I Love Amy/Chapter 5/",  count: 39 },
        { title: "A Present",               folder: "/I Love Amy/Chapter 6/",  count: 64 },
        { title: "Cut Ties with Her",       folder: "/I Love Amy/Chapter 7/",  count: 62 },
        { title: "Again",                   folder: "/I Love Amy/Chapter 8/",  count: 65 },
        { title: "Nightmare",               folder: "/I Love Amy/Chapter 9/",  count: 67 },
        { title: "Sleepless Night",         folder: "/I Love Amy/Chapter 10/", count: 59 },
        { title: "Date (1)",                folder: "/I Love Amy/Chapter 11/", count: 58 },
        { title: "Date (2)",                folder: "/I Love Amy/Chapter 12/", count: 67 },
        { title: "Amy Gets Kidnapped?!",    folder: "/I Love Amy/Chapter 13/", count: 58 },
        { title: "The Reden Family (1)",    folder: "/I Love Amy/Chapter 14/", count: 58 },
        { title: "The Reden Family (2)",    folder: "/I Love Amy/Chapter 15/", count: 59 },
        { title: "The Reden Family (3)",    folder: "/I Love Amy/Chapter 16/", count: 59 },
        { title: "Camilla's Day",           folder: "/I Love Amy/Chapter 17/", count: 58 },
        { title: "I Hate Parties (1)",      folder: "/I Love Amy/Chapter 18/", count: 22 },
        { title: "I Hate Parties (2)",      folder: "/I Love Amy/Chapter 19/", count: 17 },
        { title: "One and The Same (1)",    folder: "/I Love Amy/Chapter 20/", count: 61 },
        { title: "One and The Same (2)",    folder: "/I Love Amy/Chapter 21/", count: 57 },
        { title: "Their Daily Lives",       folder: "/I Love Amy/Chapter 22/", count: 57 },
        { title: "Do-Nothing Day",          folder: "/I Love Amy/Chapter 23/", count: 56 },
        { title: "The Amusement Park (1)",  folder: "/I Love Amy/Chapter 24/", count: 56 },
        { title: "The Amusement Park (2)",  folder: "/I Love Amy/Chapter 25/", count: 58 },
        { title: "Camilla and Amy (1)",     folder: "/I Love Amy/Chapter 26/", count: 62 },
        { title: "Camilla and Amy (2)",     folder: "/I Love Amy/Chapter 27/", count: 57 },
        { title: "Camilla and Amy (3)",     folder: "/I Love Amy/Chapter 28/", count: 63 },
        { title: "Camilla and Amy (4)",     folder: "/I Love Amy/Chapter 29/", count: 63 },
        { title: "Camilla and Amy (5)",     folder: "/I Love Amy/Chapter 30/", count: 64 },
        { title: "The Calm Before The Storm", folder: "/I Love Amy/Chapter 31/", count: 64 },
        { title: "Backstage Notes",         folder: "/I Love Amy/Chapter 32/", count: 26 },
        { title: "To Kill A Peter",         folder: "/I Love Amy/Chapter 33/", count: 59 },
        { title: "Cookie Jar (1)",          folder: "/I Love Amy/Chapter 34/", count: 59 },
        { title: "Cookie Jar (2)",          folder: "/I Love Amy/Chapter 35/", count: 62 },
        { title: "Cookie Jar (3)",          folder: "/I Love Amy/Chapter 36/", count: 36 },
        { title: "Sleeping With The Enemy", folder: "/I Love Amy/Chapter 37/", count: 20 },
        { title: "Amy's Dream (1)",         folder: "/I Love Amy/Chapter 38/", count: 56 },
        { title: "Amy's Dream (2)",         folder: "/I Love Amy/Chapter 39/", count: 23 },
        { title: "Bibi And Camilla",        folder: "/I Love Amy/Chapter 40/", count: 49 },
        { title: "Road Movie (1)",          folder: "/I Love Amy/Chapter 41/", count: 60 },
        { title: "Road Movie (2)",          folder: "/I Love Amy/Chapter 42/", count: 32 },
        { title: "Prom Night",              folder: "/I Love Amy/Chapter 43/", count: 56 },
        { title: "Recovery",                folder: "/I Love Amy/Chapter 44/", count: 49 },
        { title: "Dear Julia",              folder: "/I Love Amy/Chapter 45/", count: 58 },
        { title: "Another Beginning",       folder: "/I Love Amy/Chapter 46/", count: 61 },
        { title: "Afterword",               folder: "/I Love Amy/Chapter 46-1/", count: 10 },
        { title: "Twitter Extras (1)",      folder: "/I Love Amy/Chapter 46-2/", count: 13 },
        { title: "I Love Bibi(1)",          folder: "/I Love Amy/Chapter 46-3/", count: 66 },
        { title: "I Love Bibi(2)",          folder: "/I Love Amy/Chapter 46-4/", count: 36 },
        { title: "I Love Bibi(3)",          folder: "/I Love Amy/Chapter 46-5/", count: 61 },
        { title: "Good Night My Baby",      folder: "/I Love Amy/Chapter 46-6/", count: 48 },
        { title: "My Stupid Cat (1)",       folder: "/I Love Amy/Chapter 46-7/", count: 47 },
        { title: "My Stupid Cat (2)",       folder: "/I Love Amy/Chapter 46-8/", count: 49 },
        { title: "My Stupid Cat (3)",       folder: "/I Love Amy/Chapter 46-9/", count: 54 },
        { title: "We Became a Family",      folder: "/I Love Amy/Chapter 46-10/", count: 46 },
        { title: "Ladies Night (1)",        folder: "/I Love Amy/Chapter 46-11/", count: 45 },
        { title: "Ladies Night (2)",        folder: "/I Love Amy/Chapter 46-12/", count: 47 }
      ],
      'Merry Marbling' : [
        { title: "Chapter 1", folder: "/Merry Marbling/Chapter 1/", count: 36 },
        { title: "Chapter 2", folder: "/Merry Marbling/Chapter 2/", count: 22 },
        { title: "Chapter 3", folder: "/Merry Marbling/Chapter 3/", count: 18 },
        { title: "Chapter 4", folder: "/Merry Marbling/Chapter 4/", count: 25 }
      ]
    };

    // Helper to create navigation UI (arrows + dropdown)
    function createChapterNav(comicTitle, chapters, currentIndex) {
      const nav = document.createElement('div');
      nav.className = 'chapter-nav';

      // Prev button
      const prevBtn = document.createElement('button');
      prevBtn.className = 'chapter-arrow';
      prevBtn.title = 'Previous Chapter';
      prevBtn.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <polyline points="15 6 9 12 15 18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>`;
      prevBtn.disabled = currentIndex === 0;

      // Dropdown
      const select = document.createElement('select');
      select.className = 'chapter-select';
      chapters.forEach((chapter, i) => {
        const opt = new Option(chapter.title, i);
        select.add(opt);
      });
      select.selectedIndex = currentIndex;

      // Next button
      const nextBtn = document.createElement('button');
      nextBtn.className = 'chapter-arrow';
      nextBtn.title = 'Next Chapter';
      nextBtn.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <polyline points="9 6 15 12 9 18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>`;
      nextBtn.disabled = currentIndex === chapters.length - 1;

      nav.appendChild(prevBtn);
      nav.appendChild(select);
      nav.appendChild(nextBtn);

      // Navigation logic
      prevBtn.onclick = () => {
        if (select.selectedIndex > 0) {
          select.selectedIndex -= 1;
          select.dispatchEvent(new Event('change'));
        }
      };
      nextBtn.onclick = () => {
        if (select.selectedIndex < chapters.length - 1) {
          select.selectedIndex += 1;
          select.dispatchEvent(new Event('change'));
        }
      };
      select.onchange = (e) => {
        const idx = parseInt(e.target.value, 10);
        loadChapterImages(comicTitle, idx);
      };

      return nav;
    }

    // Helper to show/hide and set back button behavior
    function showBackButton(onClick) {
      const btn = document.getElementById('back-arrow-btn');
      btn.classList.remove('hide');
      btn.onclick = onClick;
    }
    function hideBackButton() {
      const btn = document.getElementById('back-arrow-btn');
      btn.classList.add('hide');
      btn.onclick = null;
    }

    function renderComics() {
      hideBackButton();
      document.getElementById('main-title').textContent = 'Comics Library';
      document.getElementById('chapter-nav-top').innerHTML = '';
      document.getElementById('chapter-nav-bottom').innerHTML = '';
      const comicListElement = document.getElementById('comic-list');
      comicListElement.innerHTML = '';

      Object.keys(comics).forEach(comicTitle => {
        const comicItem = document.createElement('div');
        comicItem.classList.add('comic-item');
        comicItem.innerHTML = `<strong>${comicTitle}</strong>`;
        comicItem.onclick = () => {
          renderChapters(comicTitle);
        };
        comicListElement.appendChild(comicItem);
      });
    }

    function renderChapters(comicTitle) {
      showBackButton(renderComics);
      document.getElementById('main-title').textContent = comicTitle;
      document.getElementById('chapter-nav-top').innerHTML = '';
      document.getElementById('chapter-nav-bottom').innerHTML = '';
      const comicListElement = document.getElementById('comic-list');
      comicListElement.innerHTML = '';

      const chapters = comics[comicTitle];
      const chapterList = document.createElement('div');
      chapterList.classList.add('comic-list');

      chapters.forEach((chapter, i) => {
        const chapterItem = document.createElement('div');
        chapterItem.classList.add('comic-item');
        chapterItem.innerHTML = `${chapter.title}`;
        chapterItem.onclick = () => {
          loadChapterImages(comicTitle, i);
        };
        chapterList.appendChild(chapterItem);
      });

      comicListElement.appendChild(chapterList);
    }

    // Only pass index, not folder/count/title
    function loadChapterImages(comicTitle, chapterIndex) {
      showBackButton(() => renderChapters(comicTitle));
      const chapters = comics[comicTitle];
      const chapter = chapters[chapterIndex];

      document.getElementById('main-title').textContent = comicTitle;
      document.getElementById('chapter-nav-top').innerHTML = '';
      document.getElementById('chapter-nav-bottom').innerHTML = '';

      // Navigation at top and bottom
      const navTop = document.createElement('div');
      navTop.appendChild(createChapterNav(comicTitle, chapters, chapterIndex));
      document.getElementById('chapter-nav-top').appendChild(navTop);

      const navBottom = document.createElement('div');
      navBottom.appendChild(createChapterNav(comicTitle, chapters, chapterIndex));
      document.getElementById('chapter-nav-bottom').appendChild(navBottom);

      // Show images
      const comicListElement = document.getElementById('comic-list');
      comicListElement.innerHTML = '';

      const imageContainer = document.createElement('div');
      imageContainer.classList.add('amy-container');
      imageContainer.id = 'amy-images';

      for (let i = 0; i < chapter.count; i++) {
        const img = document.createElement('img');
        img.className = 'amy-image';
        img.alt = `Page ${i + 1}`;
        img.src = `/comics${chapter.folder}${String(i).padStart(3, '0')}.jpg`;
        imageContainer.appendChild(img);
      }

      comicListElement.appendChild(imageContainer);
    }

    window.addEventListener('DOMContentLoaded', () => {
      renderComics();
    });
  </script>
      <footer>
    <p>&copy; 2025 Dipilodopilasaurus Nest. All Rights Reserved.</p>
  </footer>
</body>
</html>