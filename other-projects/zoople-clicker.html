<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zoople Cookie Clicker</title>
  <style>
    /* Base styles... (unchanged) */
    body { margin: 0; font-family: sans-serif; background: url('/images/backgrounds/starry_night.png') no-repeat center/cover; overflow: hidden; }
    @media (max-width: 768px) { body { overflow: auto; } }
    #container { display: flex; height: 100vh; position: relative; }
    .panel { position: absolute; top: 0; bottom: 0; width: 300px; background-color: rgba(0,0,0,0.8); color: white; padding:16px; box-sizing:border-box; z-index:10; transform: translateX(-100%); transition: transform 0.3s ease; }
    .panel.open { transform: translateX(0); }
    .panel.right { right:0; left:auto; transform: translateX(100%); }
    .panel.right.open { transform: translateX(0); }
    .panel h2 { margin:0 0 16px; font-size:1.25em; border-bottom:1px solid #555; padding-bottom:8px; user-select:none; }
    .panel .toggle-tab { position:absolute; top:20px; width:30px; height:40px; background:rgba(0,0,0,0.7); color:#fff; font-size:18px; display:flex; align-items:center; justify-content:center; cursor:pointer; z-index:11; user-select:none; }
    #upgrades .toggle-tab { right:-30px; }
    #shop .toggle-tab { left:-30px; }
    @media(max-width:768px){ .panel.open ~ .panel.open { transform: translateX(100%); } }
    .item-container { display:flex; flex-direction:column; margin-bottom:16px; }
    .item-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:4px; }
    .item-info { flex:1; margin-right:8px; }
    .item-info h3 { margin:0; font-size:1em; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .item-info p { margin:2px 0 0; font-size:0.75em; color:#ccc; white-space:normal; word-wrap:break-word; }
    .item-count { font-size:1.2em; user-select:none; text-align:right; }
    .item-button { padding:8px; font-size:1em; border:none; border-radius:4px; cursor:pointer; background:#444; color:#fff; transition: background 0.2s; width:100%; user-select:none; }
    .item-button.enabled { background:#4caf50; }
    .item-button:disabled { opacity:0.5; cursor:default; }
    .item-action { display:flex; gap:8px; margin-top:4px; }
    .item-action .item-button, .item-action .autobuy-select { width:50%; }
    .autobuy-select option[value="off"] { display:none; }
    img { user-select:none; -webkit-user-drag:none; pointer-events:none; }
    #center { flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; position:relative; overflow-y:auto; padding-top:20px; }
    #zoopleBox { background:rgba(128,128,128,0.8); padding:20px; border-radius:12px; margin-bottom:20px; }
    #zoopleWrapper { width:200px; height:200px; position:relative; }
    #zoople { width:100%; height:100%; background:url('/images/zoople-clicker/zoople/zoople.png') no-repeat center/contain; cursor:pointer; }
    @keyframes shake { 0%,100%{transform:translate(0,0);} 20%,60%{transform:translate(-5px,0);} 40%,80%{transform:translate(5px,0);} }
    .shake { animation: shake 0.3s ease-in-out; }
    /* Labels */
    #labelsBox { display:flex; gap:20px; background:rgba(128,128,128,0.8); padding:10px; border-radius:12px; }
    .labelItem { flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; position:relative; }
    .labelItem img { width:auto; height:auto; max-width:none; max-height:none; }
    .labelValue { position:absolute; top:65%; left:50%; transform:translate(-50%,-50%); font-size:1.5em; font-weight:bold; color:#fff; user-select:none; }
    @media(max-width:768px){ #labelsBox { flex-direction:column; } }
    #haze { position:absolute; top:0; left:0; width:100%; height:100%; background: radial-gradient(circle at 20% 20%, rgba(0,255,0,0.2),transparent 40%), radial-gradient(circle at 80% 40%, rgba(0,200,0,0.15),transparent 50%), radial-gradient(circle at 50% 80%, rgba(0,150,0,0.1),transparent 60%); filter:blur(15px); pointer-events:none; opacity:0; transition:opacity 0.5s ease; }
  </style>
</head>

<body>
  <div id="container">
    <div class="panel" id="upgrades">
      <h2>Upgrades</h2>
      <div id="toggleLeft" class="toggle-tab">❮</div>
      <!-- items... -->
    </div>
    <div class="panel right" id="shop">
      <h2>Trinkets</h2>
      <div id="toggleRight" class="toggle-tab">❯</div>
      <!-- items... -->
    </div>
    <div id="center">
      <div id="zoopleBox"><div id="zoopleWrapper"><div id="zoople"></div></div></div>
      <div id="labelsBox">
        <div class="labelItem"><img src="/images/zoople-clicker/labels/zooplier.png"><div id="multDisplay" class="labelValue">1x</div></div>
        <div class="labelItem"><img src="/images/zoople-clicker/labels/zooscore.png"><div id="scoreDisplay" class="labelValue">0</div></div>
        <div class="labelItem"><img src="/images/zoople-clicker/labels/highmeter.png"><div id="highDisplay" class="labelValue">0%</div></div>
      </div>
    </div>
  </div>
  <div id="haze"></div>
  <script>
    // State
    let score=0, clickValue=1, zooplicationCount=0, autoClickerCount=0, desperationCount=0, crackCount=0, autoBuyerCount=0, bluntCount=0;
    let autoBuyerEnabled=false;
    // Pricing
    const upgradeBase={zooplication:50,autoClicker:100,desperation:150,crack:1000,autoBuyer:500,blunt:200};
    const exponents={zooplication:1.5,autoClicker:1.25,desperation:1.3,crack:1.5,autoBuyer:1.4,blunt:2};
    function calcPrice(type,count){return Math.ceil(upgradeBase[type]*Math.pow(exponents[type],count));}
    let prices={};Object.keys(upgradeBase).forEach(k=>prices[k]=calcPrice(k,0));
    // Elements
    const elements={ score:document.getElementById('scoreDisplay'), mult:document.getElementById('multDisplay'), high:document.getElementById('highDisplay'), count:{zooplication:document.getElementById('count-zooplication'),autoClicker:document.getElementById('count-autoClicker'),desperation:document.getElementById('count-desperation'),crack:document.getElementById('count-crack'),autoBuyer:document.getElementById('count-autoBuyer'),blunt:document.getElementById('count-blunt')}, btn:{zooplication:document.getElementById('btn-zooplication'),autoClicker:document.getElementById('btn-autoClicker'),desperation:document.getElementById('btn-desperation'),crack:document.getElementById('btn-crack'),autoBuyer:document.getElementById('btn-autoBuyer'),blunt:document.getElementById('btn-blunt')}, toggleAuto:document.getElementById('toggle-autoBuyer'), selectAuto:document.getElementById('select-autoBuyer'), actionAuto:document.getElementById('action-autoBuyer') };
    function updateDisplay(){elements.score.textContent=Math.floor(score);elements.mult.textContent=(1+bluntCount*0.01).toFixed(2)+'x';elements.high.textContent='0%';Object.keys(elements.btn).forEach(key=>{const btn=elements.btn[key],cnt={zooplication:zooplicationCount,autoClicker:autoClickerCount,desperation:desperationCount,crack:crackCount,autoBuyer:autoBuyerCount,blunt:bluntCount}[key];btn.textContent='Buy ('+prices[key]+')';btn.disabled=score<prices[key];btn.classList.toggle('enabled',score>=prices[key]);elements.count[key].textContent=cnt;});if(autoBuyerCount>0){elements.btn.autoBuyer.style.display='none';elements.actionAuto.style.display='flex';}else{elements.btn.autoBuyer.style.display='block';elements.actionAuto.style.display='none';}}
    // Crack factor
    const crackFactor=0.2;
    // Buy
    function buy(key){if(score<prices[key])return;score-=prices[key];switch(key){case'zooplication':zooplicationCount++;clickValue=1+zooplicationCount;break;case'autoClicker':autoClickerCount++;restartAutoClick();break;case'desperation':desperationCount++;break;case'crack':crackCount++;restartAutoClick();break;case'autoBuyer':autoBuyerCount++;break;case'blunt':bluntCount++;break;}prices[key]=calcPrice(key,{zooplication:zooplicationCount,autoClicker:autoClickerCount,desperation:desperationCount,crack:crackCount,autoBuyer:autoBuyerCount,blunt:bluntCount}[key]);updateDisplay();}
    Object.keys(elements.btn).forEach(key=>elements.btn[key].addEventListener('click',()=>buy(key)));
    // Restart auto-click with hyperbolic speed-up
    function restartAutoClick(){if(window.autoInterval)clearInterval(window.autoInterval);const reduction=1-1/(1+crackFactor*crackCount);const intervalMs=1000*(1-reduction);window.autoInterval=setInterval(()=>{score+=autoClickerCount;updateDisplay();},Math.max(50,intervalMs));}
    // Auto-buyer toggle
    elements.toggleAuto.addEventListener('click',()=>{autoBuyerEnabled=!autoBuyerEnabled;elements.toggleAuto.classList.toggle('enabled',autoBuyerEnabled);});
    setInterval(()=>{if(!autoBuyerEnabled)return;const c=elements.selectAuto.value;if(c==='upgrades'){['zooplication','autoClicker','desperation','crack'].forEach(buy);}else if(c==='trinkets'){buy('blunt');}else buy(c);},500);
    // Zoople click + shake
    const zoopleEl=document.getElementById('zoople');
    zoopleEl.addEventListener('click',()=>{score+=clickValue;const cannotAfford=['zooplication','autoClicker','crack','autoBuyer'].every(k=>score<prices[k]);if(desperationCount>0&&cannotAfford){score+=desperationCount*2;}updateDisplay();zoopleEl.classList.add('shake');zoopleEl.addEventListener('animationend',()=>zoopleEl.classList.remove('shake'),{once:true});});
    // Panel toggles
    document.getElementById('toggleLeft').addEventListener('click',()=>{document.getElementById('upgrades').classList.toggle('open');if(window.innerWidth<=768)document.getElementById('shop').classList.remove('open');});
    document.getElementById('toggleRight').addEventListener('click',()=>{document.getElementById('shop').classList.toggle('open');if(window.innerWidth<=768)document.getElementById('upgrades').classList.remove('open');});
    // Init
    updateDisplay();
  </script>
</body>

</html>
